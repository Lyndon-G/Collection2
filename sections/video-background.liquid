{% schema %}
{
  "name": "Video Background",
  "settings": [
    {
      "type": "header",
      "content": "Video Settings"
    },
    {
      "type": "video_url",
      "id": "video_url",
      "label": "Video URL",
      "accept": ["youtube", "vimeo"],
      "info": "Add YouTube or Vimeo URL"
    },
    {
      "type": "url",
      "id": "video_mp4",
      "label": "MP4 Video File",
      "info": "Upload MP4 directly or provide URL"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 100,
      "step": 10,
      "unit": "%",
      "label": "Overlay Opacity",
      "default": 40
    },
    {
      "type": "header",
      "content": "Content Settings"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Video Background Section"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Text Content",
      "default": "<p>Add your compelling text here</p>"
    },
    {
      "type": "select",
      "id": "text_color",
      "label": "Text Color",
      "options": [
        {
          "value": "text-white",
          "label": "White"
        },
        {
          "value": "text-black",
          "label": "Black"
        }
      ],
      "default": "text-white"
    },
    {
      "type": "header",
      "content": "Button Settings"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Shop Now"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button Link"
    },
    {
      "type": "select",
      "id": "button_style",
      "label": "Button Style",
      "options": [
        {
          "value": "btn-primary",
          "label": "Primary"
        },
        {
          "value": "btn-secondary",
          "label": "Secondary"
        },
        {
          "value": "btn-outline",
          "label": "Outline"
        }
      ],
      "default": "btn-primary"
    }
  ],
  "presets": [
    {
      "name": "Video Background",
      "category": "Video"
    }
  ]
}
{% endschema %}

{% style %}
.video-section {
  position: relative;
  width: 100%;
  height: 100vh;
  min-height: 500px;
  overflow: hidden;
}

.video-section__video {
  position: absolute;
  top: 50%;
  left: 50%;
  min-width: 100%;
  min-height: 100%;
  width: auto;
  height: auto;
  transform: translate(-50%, -50%);
  object-fit: cover;
}

.video-section__overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, {{ section.settings.overlay_opacity | divided_by: 100.0 }});
}

.video-section__content {
  position: relative;
  z-index: 2;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  padding: 20px;
}

.video-section__heading {
  font-size: 2.5rem;
  margin-bottom: 1rem;
}

.video-section__text {
  max-width: 600px;
  margin-bottom: 2rem;
}

.btn {
  padding: 15px 30px;
  border-radius: 4px;
  text-decoration: none;
  transition: all 0.3s ease;
}

.btn-primary {
  background-color: {{ settings.primary_button_background }};
  color: {{ settings.primary_button_text }};
}

.btn-secondary {
  background-color: {{ settings.secondary_button_background }};
  color: {{ settings.secondary_button_text }};
}

.btn-outline {
  background-color: transparent;
  border: 2px solid currentColor;
}

@media screen and (max-width: 768px) {
  .video-section {
    height: 60vh;
  }
  
  .video-section__heading {
    font-size: 2rem;
  }
}
{% endstyle %}

<div class="video-section">
  {% if section.settings.video_mp4 != blank %}
    <video class="video-section__video" autoplay loop muted playsinline>
      <source src="{{ section.settings.video_mp4 }}" type="video/mp4">
    </video>
  {% elsif section.settings.video_url != blank %}
    {% if section.settings.video_url.type == "youtube" %}
      <iframe class="video-section__video" src="https://www.youtube.com/embed/{{ section.settings.video_url.id }}?autoplay=1&loop=1&mute=1&playlist={{ section.settings.video_url.id }}&controls=0&showinfo=0" frameborder="0" allowfullscreen></iframe>
    {% elsif section.settings.video_url.type == "vimeo" %}
      <iframe class="video-section__video" src="https://player.vimeo.com/video/{{ section.settings.video_url.id }}?background=1&autoplay=1&loop=1&byline=0&title=0" frameborder="0" allowfullscreen></iframe>
    {% endif %}
  {% endif %}
  
  <div class="video-section__overlay"></div>
  
  <div class="video-section__content">
    {% if section.settings.heading != blank %}
      <h2 class="video-section__heading {{ section.settings.text_color }}">
        {{ section.settings.heading }}
      </h2>
    {% endif %}
    
    {% if section.settings.text != blank %}
      <div class="video-section__text {{ section.settings.text_color }}">
        {{ section.settings.text }}
      </div>
    {% endif %}
    
    {% if section.settings.button_text != blank and section.settings.button_link != blank %}
      <a href="{{ section.settings.button_link }}" class="btn {{ section.settings.button_style }} {{ section.settings.text_color }}">
        {{ section.settings.button_text }}
      </a>
    {% endif %}
  </div>
</div>