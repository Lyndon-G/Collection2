{%- if section.blocks.size > 0 -%}
  {%- for block in section.blocks -%}
    {% if block.type == 'video' %}
      <div class="videoBox" style="{%- if block.settings.video_link == blank -%}background-image: url('{{ block.settings.video_image | img_url: 'master' }}');{%- endif -%}">
        {%- if block.settings.video_link != blank -%}
          <div class="fullscreen-video-wrap">
            <video 
              class="video-js" 
              loop 
              autoplay 
              preload="metadata"
              muted 
              playsinline
              loading="lazy"
              poster="https:{{ block.settings.video_image | img_url: 'master' }}"
            >
              <source src="{{ block.settings.video_link }}" type="video/mp4">
            </video>
          </div>
        {% endif %}

        <div class="overlay" style="opacity: 0.{{ block.settings.overlay_opacity }}"></div>
        
        <div class="videoBoxInfo">
          {% if block.settings.title != blank %}
            <h1 class="videoBoxInfoTitle" style="color: {{ block.settings.color_text }}">
              {{ block.settings.title | escape }}
            </h1>
          {% endif %}

          {% if block.settings.text != blank %}
            <div class="imageBoxInfoDescription" style="color: {{ block.settings.color_text }}">
              {{ block.settings.text }}
            </div>
          {% endif %}

          {% if block.settings.button_link != blank and block.settings.button_label != blank %}
            <a 
              href="{{ block.settings.button_link }}" 
              class="videoBoxInfoBtn" 
              style="color: {{ block.settings.color_btn_text }}; background: {{ block.settings.color_btn_bg }}"
            >
              {{ block.settings.button_label | escape }}
            </a>
          {% endif %}
        </div>
      </div>

    {% else %}
      <div class="imageBox" style="background-color: {{ block.settings.color_bg }}; {%- if block.settings.image_bg != blank -%}background-image: url('{{ block.settings.image_bg | img_url: 'master' }}');{%- endif -%}">
        <div class="overlay" style="opacity: 0.{{ block.settings.overlay_opacity }}"></div>
        <div class="imageBoxInfo">
          {% if block.settings.title != blank %}
            <h1 class="imageBoxInfoTitle" style="color: {{ block.settings.color_text }}">
              {{ block.settings.title | escape }}
            </h1>
          {% endif %}

          {% if block.settings.text != blank %}
            <div class="imageBoxInfoDescription" style="color: {{ block.settings.color_text }}">
              {{ block.settings.text }}
            </div>
          {% endif %}

          {% if block.settings.button_link != blank and block.settings.button_label != blank %}
            <a 
              href="{{ block.settings.button_link }}" 
              class="imageBoxInfoBtn" 
              style="color: {{ block.settings.color_btn_text }}; background: {{ block.settings.color_btn_bg }}"
            >
              {{ block.settings.button_label | escape }}
            </a>
          {% endif %}
        </div>
      </div>
    {% endif %}
  {%- endfor -%}

{% else %}
  <div class="placeholderNoblocks">
    This section doesn't currently include any content. Add content to this section using the sidebar.
  </div>
{%- endif -%}

<style>
  /* Video Background Container */
  .videoBackground {
    position: relative;
    height: 100%;
    margin-top: -55px;
  }

  /* Video Wrapper */
  .fullscreen-video-wrap {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }

  .fullscreen-video-wrap .video-js,
  .fullscreen-video-wrap video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Content Boxes */
  .videoBox,
  .imageBox {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    flex-direction: column;
    padding: 100px 20px 80px;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    position: relative;
    min-height: calc(100vh - 165px);
  }

  .videoBox {
    max-height: 800px;
  }

  /* Content Info */
  .videoBoxInfo,
  .imageBoxInfo {
    position: relative;
    z-index: 2;
    text-align: center;
  }

  /* Overlay */
  .overlay {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background: #000;
    z-index: 1;
  }

  /* Text Styles */
  .videoBoxInfoTitle,
  .imageBoxInfoTitle {
    color: #FFF;
    font-size: 30px;
    line-height: 1.3;
  }

  .videoBoxInfoDescription,
  .imageBoxInfoDescription {
    max-width: 500px;
    margin: 0 auto;
  }

  .videoBoxInfoDescription p,
  .imageBoxInfoDescription p {
    font-size: 18px;
    line-height: 1.6;
  }

  /* Button Styles */
  .videoBoxInfoBtn,
  .imageBoxInfoBtn {
    display: inline-block;
    padding: 8px 15px;
    margin-top: 20px;
    border-radius: 2px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    font-size: 14px;
    text-decoration: none;
    cursor: pointer;
    border: 1px solid transparent;
  }

  /* Placeholder */
  .placeholderNoblocks {
    text-align: center;
    max-width: 500px;
    margin: 0 auto;
  }

  /* Mobile Styles */
  @media screen and (max-width: 767px) {
    .videoBackground {
      margin-top: -35px;
    }

    .videoBox {
      min-height: 500px;
      padding: 0;
    }

    .fullscreen-video-wrap {
      position: relative;
      min-height: 300px;
      z-index: 3;
    }

    .videoBoxInfo {
      padding: 40px 20px;
      background: #000;
      width: 100%;
    }
  }
</style>

{% schema %}
{
  "name": {
    "en": "Video Background"
  },
  "class": "videoBackground",
  "max_blocks": 1,
  "blocks": [
    {
      "type": "video",
      "name": "Video",
      "settings": [
        {
          "type": "url",
          "id": "video_link",
          "label": {
            "en": "Video link"
          }
        },
        {
          "type": "image_picker",
          "id": "video_image",
          "label": {
            "en": "Cover image"
          }
        },
        {
          "type": "range",
          "id": "overlay_opacity",
          "label": {
            "en": "Overlay opacity"
          },
          "min": 0,
          "max": 99,
          "step": 1,
          "unit": {
            "en": "%"
          },
          "default": 0
        },
        {
          "type": "text",
          "id": "title",
          "label": {
            "en": "Heading"
          },
          "default": "Video slide"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": {
            "en": "Description"
          },
          "default": {
            "en": "<p>Use this text to share information about your brand with your customers.</p>"
          }
        },
        {
          "type": "color",
          "id": "color_text",
          "label": {
            "en": "Text color"
          },
          "default": "#ffffff"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": {
            "en": "Button label"
          }
        },
        {
          "type": "url",
          "id": "button_link",
          "label": {
            "en": "Button link"
          }
        },
        {
          "type": "color",
          "id": "color_btn_bg",
          "label": {
            "en": "Background button color"
          },
          "default": "#ffffff"
        },
        {
          "type": "color",
          "id": "color_btn_text",
          "label": {
            "en": "Button text color"
          },
          "default": "#ffffff"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": {
        "en": "Video Background"
      },
      "category": {
        "en": "Main"
      },
      "blocks": [
        {
          "type": "video"
        }
      ]
    }
  ]
}
{% endschema %}